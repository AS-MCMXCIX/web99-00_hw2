<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>login</title>
    <link href='https://cdn.fontcdn.ir/Font/Persian/Sahel/Sahel.css' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css"
          integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <link rel="stylesheet" href="css/buttons-hw2.css">
    <link rel="stylesheet" href="css/supinForm.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="css/login.css">
</head>
<body>
<div class="top-nav">
    <a class="go-home" href="home.html">&lt; بازگشت به خانه</a>
    <img style="position: absolute;top: 50%;right:0;height: 100%;width: 40%;max-width: 300px;transform: translate(0, -40%)"
         src="files/blue_logo_175x75.png"
         alt="None">
</div>
<div class="center above-600px">
    <div style="position: relative">
        <picture>
            <source media="(min-width:1000px)" srcset="files/signup-highQ-light.jpg">
            <source media="(max-width:1000px)" srcset="files/signup-lowQ-light.jpg">
            <img src="files/signup-highQ-light.jpg" alt="sign image" style="width: 67%;height: 50vh;">
        </picture>
        <div style="background-color: rgba(0,0,255, 0.1);text-align:center;color:blueviolet;font-family: Orbitron;font-size: 200%;display:inline-block;position: absolute;left: 33.5%; top: 50%;transform:translate(-50%, -50%)">
            Why SignUp Now When You Can SignUp Later???
        </div>
    </div>
</div>
<div class="supInFormContainer">
    <div class="d-block" style="width: 33%;height: 100%;background-color: white;float: right">
        <div class="btn-group btn-group-lg btn-group-toggle w-100" data-toggle="buttons"
             style="background-color: white">
            <label class="btn btn-b-w-b rounded-0 w-100">
                <input type="radio" name="options" id="signin-section-button" onchange="signupRadioOnChange()">ورود
            </label>
            <label class="btn btn-b-w-b rounded-0 w-100 active">
                <input type="radio" name="options" id="signup-section-button" onchange="signupRadioOnChange()">ثبت
                نام
            </label>
        </div>
        <div class="d-flex justify-content-center" style="background-color: white">
            <form style="direction: rtl;" class="w-75" id="signup-form">
                <br>
                <div class="form-group">
                    <input type="email" class="form-control form-input-fa" id="signup-email-input"
                           aria-describedby="emailHelp"
                           placeholder="ایمیل">
                </div>
                <div class="form-group">
                    <input type="password" class="form-control form-input-fa" id="signup-pass-input"
                           placeholder="رمز عبور">
                </div>
                <div class="form-group">
                    <input type="password" class="form-control form-input-fa" id="signup-repass-input"
                           placeholder="تکرار رمز عبور">
                </div>
                <div class="form-group form-check float-right">
                    <input type="checkbox" class="form-check-input" id="accept-terms">
                    <label class="form-check-label" style="margin-right: 1.25rem;font-family: Sahel;color: #73A1C2"
                           for="accept-terms">قوانین
                        و شرایط را می
                        پذیرم</label>
                </div>
                <br>
                <div class="d-flex justify-content-center" style="background-color: blue;width: 100%">
                    <button type="submit" class="btn btn-primary w-100" style="font-family: Sahel"
                            onclick="return validateSignup()">ثبت نام
                    </button>
                </div>

                <div id="alert-sup" class="alert alert-primary fade d-flex"
                     style="text-align: right; border-right-width: 1rem; margin-top: 0.8rem;padding: 0.3rem 0.5rem;"
                     role="alert">
                    <label id="error-message-sup"
                           style="margin-left: auto;font-family: Sahel;float: right;background-color: transparent">لطفا
                        ایمیل معتبر وارد کنید.</label>
                    <button type="button" class="btn-circle"
                            aria-label="Close" id="alert-sup-close"><i class="fa fa-times"></i>
                    </button>
                </div>
            </form>
            <form style="direction: rtl;display: none;" class="w-75" id="signin-form">
                <br>
                <div class="form-group">
                    <input type="email" class="form-control form-input-fa" id="signin-email-input"
                           aria-describedby="emailHelp"
                           placeholder="ایمیل">
                </div>
                <div class="form-group">
                    <input type="password" class="form-control form-input-fa" id="signin-pass-input"
                           placeholder="رمز عبور">
                </div>
                <br>
                <div class="d-flex justify-content-center" style="background-color: blue;width: 100%">
                    <button type="submit" class="btn btn-primary w-100" style="font-family: Sahel"
                            onclick="return validateSignIn()">ورود
                    </button>
                </div>

                <div id="alert-sin" class="alert alert-primary fade d-flex"
                     style="text-align: right; border-right-width: 1rem; margin-top: 0.8rem;padding: 0.3rem 0.5rem;"
                     role="alert">
                    <label id="error-message-sin"
                           style="margin-left: auto;font-family: Sahel;float: right;background-color: transparent">لطفا
                        ایمیل معتبر وارد کنید.</label>
                    <button id="alert-sin-close" type="button" class="btn-circle"
                            aria-label="Close"><i class="fa fa-times"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
</body>
<script>
    let sin_mail = document.getElementById('signin-email-input');
    let sin_pass = document.getElementById('signin-pass-input');
    let sup_mail = document.getElementById('signup-email-input');
    let sup_pass = document.getElementById('signup-pass-input');
    let sup_repass = document.getElementById('signup-repass-input');
    let accept_terms = document.getElementById('accept-terms');
    let error_message_sup = document.getElementById('error-message-sup');
    let error_message_sin = document.getElementById('error-message-sin');

    let messages_en = ['please enter a password.', 'please repeat password.', 'please repeat password correctly.',
        'please enter a valid email.', 'Welcome!', 'Wrong Password!', 'No Such User!', 'please accept terms.'];
    let messages_fa = ['لطفاً رمز را وارد کنید.', 'لطفاً رمز را تکرار کنید.', 'لطفاً رمز را به درستی تکرار کنید.',
        'لطفاً ایمیل معتبر وارد کنید.', 'حوش آمدید!', 'رمز اشتباه است!', 'چنین کاربری وجود ندارد!', 'لطفاً قوانین را بپذیرید.'];

    let pass_state_messages = [messages_fa[0], messages_fa[1], messages_fa[2]];
    let db_signIn_state_messages = [messages_fa[4], messages_fa[5], messages_fa[6]];

    function signupRadioOnChange() {
        let active = document.getElementById('signin-section-button').checked;
        if (active) {
            document.getElementById('signin-form').style.display = 'block';
            document.getElementById('signup-form').style.display = 'none';
        } else {
            document.getElementById('signin-form').style.display = 'none';
            document.getElementById('signup-form').style.display = 'block';
        }
    }

    document.getElementById('alert-sup-close').onclick = function () {
        document.getElementById('alert-sup').classList.remove('show');
    };
    document.getElementById('alert-sin-close').onclick = function () {
        document.getElementById('alert-sin').classList.remove('show');
    };

    function validateSignup() {
        document.getElementById('alert-sup').classList.add('show');
        if (!validateEmail(sup_mail.value)) {
            error_message_sup.innerHTML = messages_fa[3];
        } else {
            let res = validatePass(sup_pass.value, sup_repass.value);

            if (res !== -1) {
                error_message_sup.innerText = pass_state_messages[res];
            } else if (!accept_terms.checked) {
                error_message_sup.innerHTML = messages_fa[7];
            } else {
                document.getElementById('alert-sup').classList.remove('show');
                return true;
            }
        }
        return false;
    }

    function validateSignIn() {
        document.getElementById('alert-sin').classList.add('show');
        if (validateEmail(sin_mail.value)) {
            let res = validateSignInBackend(sin_mail.value, sin_pass.value);
            error_message_sin.innerHTML = db_signIn_state_messages[res];
            if (res === 0) {
                document.getElementById('alert-sin').classList.remove('show');
                return true;
            }
            return false;
        }
        error_message_sin.innerHTML = messages_fa[3];
        return false;
    }

    function validateSignInBackend(email, pass) {
        let email_id_map = new Map();
        email_id_map.set('ex@mail.com', 'ex_usr_id');
        let db = new Map;
        db.set('ex_usr_id', ['ex_usr_pass', 'ex@mail.com']); // an example
        if (email_id_map.has(email)) {
            let usr = db.get(email_id_map.get(email));
            if (usr[0] === pass)
                return 0;
            return 1;
        }
        return 2;
    }

    function validateEmail(email) {
        const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
    }

    function validatePass(pass, pass2) {
        if (pass === "") {
            return 0;
        } else if (pass2 === "") {
            return 1;
        }
        return pass === pass2 ? -1 : 2;
    }
</script>
<script>
    let activeSection = 'signUp';

    init();

    function init() {
        try {
            var url = document.location.href;
            var params = url.split('?')[1].split('&');
            var data = {}, tmp;
            for (var i = 0, l = params.length; i < l; i++) {
                tmp = params[i].split('=');
                data[tmp[0]] = tmp[1];
            }
            goToSection(data.state);
        } catch (e){
            goToSection('signUp');
        }
    }

    function goToSection(s) {
        if (s === 'signUp'){
            document.getElementById('signup-section-button').click();
        } else{
            document.getElementById('signin-section-button').click();
        }
    }

    function setActiveButton(btn) {
        if (btn.id !== activeSection) {
            btn.classList.add("active");
        }
    }

    function setInactiveButton(btn) {
        btn.classList.remove("active");
    }
</script>
</html>